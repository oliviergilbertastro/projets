<!DOCTYPE html>
<html>
<head>
<style>


</style>
</head>

<body style="margin: 0 !important;
    padding: 0 !important;overflow: hidden; ">

<canvas id="myCanvas" onclick="Click()" onmousedown="mousedown()" onmousemove="mousepos(event)" width="window.innerWidth;" height="window.innerHeight;" style="background-color:black; "></canvas>

<script>

myCanvas.width = window.innerWidth;
myCanvas.height = window.innerHeight;
console.log(myCanvas.height)
if (myCanvas.height > 872) {
    myCanvas.height = 872;
}

var c = document.getElementById("myCanvas");
var ctx = c.getContext("2d");





var mouseX = null;
var mouseY = null;
var hovering_above_maps = false;
var hovering_above_yt = false;
var bothering_otter = false;
var dist_between_icons = 10;

c.addEventListener("touchstart", function(event) {
    mouseX = event.changedTouches[0].pageX;
    mouseY = event.changedTouches[0].pageY;

    if ((mouseX >= 10 && mouseX <= 160) && ((mouseY >= myCanvas.height/2-75 && mouseY <= myCanvas.height/2+75))) {
        hovering_above_maps = true;
    } else {
        hovering_above_maps = false;
    }
    if ((mouseX >= 10 && mouseX <= 160) && ((mouseY >= myCanvas.height/2-75+(150+dist_between_icons) && mouseY <= myCanvas.height/2+75+(150+dist_between_icons)))) {
        hovering_above_yt = true;
    } else {
        hovering_above_yt = false;
    }

    if ((mouseX >= myCanvas.width/2-330 && mouseX <= myCanvas.width/2-180) && ((mouseY >= myCanvas.height-290 && mouseY <= myCanvas.height-140))) {
        bothering_otter = true;
    } else {
        bothering_otter = false;
    }
    


});

c.addEventListener("touchend", function(event) {

    if (hovering_above_maps) {
        onMapsClick();
    }
    if (hovering_above_yt) {
        onYTClick();
    }
    bothering_otter = false;

});

c.addEventListener("touchmove", function(event) {
    mouseX = event.changedTouches[0].pageX;
    mouseY = event.changedTouches[0].pageY;
    event.preventDefault();
    if ((mouseX >= 10 && mouseX <= 160) && ((mouseY >= myCanvas.height/2-75 && mouseY <= myCanvas.height/2+75))) {
        hovering_above_maps = true;
    } else {
        hovering_above_maps = false;
    }
    if ((mouseX >= 10 && mouseX <= 160) && ((mouseY >= myCanvas.height/2-75+(150+dist_between_icons) && mouseY <= myCanvas.height/2+75+(150+dist_between_icons)))) {
        hovering_above_yt = true;
    } else {
        hovering_above_yt = false;
    }
    if ((mouseX >= myCanvas.width/2-330 && mouseX <= myCanvas.width/2-180) && ((mouseY >= myCanvas.height-290 && mouseY <= myCanvas.height-140))) {
        bothering_otter = true;
    } else {
        bothering_otter = false;
    }
});




var elementToChange = document.getElementsByTagName("body")[0];
//myCanvas.style.cursor = "grab";

var grass_path = new Image();
grass_path.src = "grass.png";
var tall_grass = new Image();
tall_grass.src = "tallgrass.png";
var train_track = new Image();
train_track.src = "train_track.png";
var train = new Image();
train.src = "train.png";
var wood_font = new Image()
wood_font.src = "WoodPressed-5x.png"
var maps_icon = new Image()
maps_icon.src = "maps_icon.png"
var yt_icon = new Image()
yt_icon.src = "youtube_icon.png"
var background = new Image()
background.src = "background.png"

var current_player = "a";
var steam_engine = document.createElement("audio");
var steam_engine2 = document.createElement("audio");
steam_engine.volume = 0.3;
steam_engine2.volume = steam_engine.volume;
steam_engine.src = "steam_engine.mp3";
steam_engine2.src = steam_engine.src;

function loopIt(){
    var player = null;

    if(current_player == "a"){
        player = steam_engine;
        current_player = "b";
    }
    else{
        player = steam_engine2;
        current_player = "a";
    }

    player.play();

    setTimeout(loopIt, 1746); //5333 is the length of the audio clip in milliseconds.
}




var otter_jump = new Array();

for(i=1; i<5; i++) {
    otter_jump[i-1] = new Image();
    otter_jump[i-1].src = `otter_sprite/otter_jump_${i}.png`;
}
for(i=1; i<4; i++) {
    otter_jump[i-1+4] = new Image();
    otter_jump[i-1+4].src = `otter_sprite/otter_land_${i}.png`;
}

var otter_sleep = new Array();

for(i=1; i<7; i++) {
    otter_sleep[i-1] = new Image();
    otter_sleep[i-1].src = `otter_sprite/otter_sleep_${i}.png`;
}

var otter_idle = new Array();

for(i=1; i<13; i++) {
    otter_idle[i-1] = new Image();
    otter_idle[i-1].src = `otter_sprite/otter_idle_alt_${i}.png`;
}



var reveal = new Date('August 24, 2024 00:00:00');
var today = new Date();

var timeleft = (reveal - today)-(1000 * 60 * 60);
var daysleft = Math.floor(timeleft / (1000 * 60 * 60 * 24));
var hoursleft = Math.floor((timeleft - daysleft*(1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
var minutesleft = Math.floor((timeleft - daysleft*(1000 * 60 * 60 * 24) - hoursleft*(1000 * 60 * 60)) / (1000 * 60));
var secondsleft = Math.floor((timeleft - daysleft*(1000 * 60 * 60 * 24) - hoursleft*(1000 * 60 * 60) - minutesleft*(1000 * 60)) / (1000));
secondsleft = String(secondsleft).padStart(2, '0');
minutesleft = String(minutesleft).padStart(2, '0');
hoursleft = String(hoursleft).padStart(2, '0');

function distance(x1,y1,x2,y2) {
return Math.sqrt(Math.pow(x1-x2,2)+Math.pow(y1-y2,2));

}

var mx;
var my;


var lastposx;
function mousepos(e){

    mx = e.clientX;
    my = e.clientY;


}


var grabbing = false;
function mousedown() {




}

function Click() {



}


setInterval(function() {

today = new Date();
timeleft = (reveal - today)-(1000 * 60 * 60);
daysleft = Math.floor(timeleft / (1000 * 60 * 60 * 24));
hoursleft = Math.floor((timeleft - daysleft*(1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
minutesleft = Math.floor((timeleft - daysleft*(1000 * 60 * 60 * 24) - hoursleft*(1000 * 60 * 60)) / (1000 * 60));
secondsleft = Math.floor((timeleft - daysleft*(1000 * 60 * 60 * 24) - hoursleft*(1000 * 60 * 60) - minutesleft*(1000 * 60)) / (1000));

secondsleft = String(secondsleft).padStart(2, '0');
minutesleft = String(minutesleft).padStart(2, '0');
hoursleft = String(hoursleft).padStart(2, '0');

}, 1000);



var myFontIndices = ["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","1","2","3","4","5","6","7","8","9","0","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z",":"," "]
function stringToFont(string) {
    var font = new Array();
    for(i=0;i<string.length;i++) {
        font.push(myFontIndices.indexOf(string[i]));
    }
    return font;
}

function drawText(string, x, y, size, fontImage) {
    fi = stringToFont(string);
    for(i=0;i<fi.length;i++) {
        ctx.drawImage(fontImage, (fi[i]%12)*75, (Math.floor(fi[i]/12))*125, 75, 125, x+(i*65*size), y, 75*size, 125*size)
    }
}

function onMapsClick() {
    window.location.href = 'https://maps.app.goo.gl/PnzWKPRH2qt9uV6PA';
}

function onYTClick() {
    window.location.href = 'https://youtube.com/playlist?list=PL5MZXI6Szc1eCArbCFg53r4bPxgvXsKNS&si=7my1zG0uAlkbMgwU';
}


var right = 0;
var rot = 0;
var scrollx = 0

function draw() {

ctx.clearRect(0,0,myCanvas.width,myCanvas.height);



// Create linear gradient
grad=ctx.createLinearGradient(0,0,0,myCanvas.height);
grad.addColorStop(0, "rgb(0,131,255)");
grad.addColorStop(1, "rgb(0,191,255)");

// Fill rectangle with gradient
ctx.fillStyle = grad;
ctx.fillRect(0,0, myCanvas.width, myCanvas.height);
ctx.fillStyle="rgba(0,0,0,0.7)";

bg_size = 1.2;
bg_scrollspeed = 0.5;
for(x=0;x<2;x+=1) {
    ctx.drawImage(background, x*(1868*bg_size)-((scrollx*bg_scrollspeed)%(1868*bg_size)), 0, 1868*bg_size, 560*bg_size)
}


for(x=-200;x<myCanvas.width+400;x+=400) {
    for(y=0;y<200;y+=200) {
        ctx.drawImage(grass_path, x-(scrollx%400), myCanvas.height-200-y, 400, 200)
    }
}
for(x=-200;x<myCanvas.width+400;x+=50) {
    ctx.drawImage(tall_grass, x-(scrollx%100), myCanvas.height-245, 50, 50)
}

var train_multiplier = 1
for(x=-200;x<myCanvas.width*2;x+=928*train_multiplier) {
    ctx.drawImage(train_track, x-(scrollx%(928*train_multiplier)), myCanvas.height-100, 928*train_multiplier, 56*train_multiplier)
}
ctx.drawImage(train, myCanvas.width/2-425, myCanvas.height-227, 850*train_multiplier, 200*train_multiplier)



//Faut changer Ã§a pour les lettres du font (75px par 125px)
//ctx.fillStyle = "white";
//ctx.font = "50px Arial";
//ctx.fillText("Voyage dans le Maine dans:", myCanvas.width/2-280, 70);

//ctx.font = "60px Arial";
//ctx.fillText(daysleft + ":"+hoursleft + ":"+minutesleft + ":"+secondsleft, myCanvas.width/2-120, 150);
if (jumping == false && idling == false) {
    ctx.drawImage(otter_sleep[Math.floor(time*5)%6], myCanvas.width/2-330, myCanvas.height-290, 150, 150)
} else if (jumping) {
    ctx.drawImage(otter_jump[Math.floor(7*(jumpstart_time/jump_length))], myCanvas.width/2-330, myCanvas.height-290-(Math.cos((jumpstart_time-(jump_length/2))/(jump_length/2)*Math.PI/2)*100), 150, 150)
} else {
    ctx.drawImage(otter_idle[Math.floor(12*(idle_time/idle_length))], myCanvas.width/2-330, myCanvas.height-290, 150, 150)
}

drawText("Voyage dans le".toUpperCase(), myCanvas.width/2-380, 20, 0.8, wood_font)
drawText("Maine dans:".toUpperCase(), myCanvas.width/2-290, 110, 0.8, wood_font)
drawText(daysleft + ":"+hoursleft + ":"+minutesleft + ":"+secondsleft, myCanvas.width/2-360, 250, 1, wood_font)



//UI
ctx.drawImage(maps_icon, 10, myCanvas.height/2-75, 150, 150)
if (hovering_above_maps) {
    ctx.fillStyle = "rgba(0,0,0,0.4)";
    ctx.fillRect(30, myCanvas.height/2-55, 110, 110);
}
ctx.drawImage(yt_icon, 10, myCanvas.height/2-75+(150+dist_between_icons), 150, 150)
if (hovering_above_yt) {
    ctx.fillStyle = "rgba(0,0,0,0.4)";
    ctx.fillRect(30, myCanvas.height/2-55+(150+dist_between_icons), 110, 110);
}

}


var jumping = false;
var jumpstart_time = 0;
var jump_length = 0.5;

var idling = false;
var idle_time = 0;
var idle_length = 1.5;
setInterval(function() {

if (bothering_otter && jumping == false && idling == false) {
    jumping = true;
    jumpstart_time = 0;
} else if (jumping) {
    jumpstart_time += 0.01;
}
if (jumpstart_time >= jump_length) {
    jumping = false;
    jumpstart_time = 0;
    idling = true;
}
if (idling) {
    idle_time += 0.01;
}
if (idle_time >= idle_length) {
    idling = false;
    idle_time = 0;
}

}, 10);


var time = 0;
setInterval(function() {
draw();

scrollx += 1
time += 0.01


}, 10);

draw();
</script>
</body>
</html>